var kaliumGroupedMetaboxes={};!function(t,e,a){"use strict";t(document).ready(function(){if("undefined"!=typeof acf){t.extend(a,{setLoading:function(e){var a;t("#kalium-acfpro-grouped-metaboxes")[e?"addClass":"removeClass"]("is-loading")},cacheId:function(){var t;return"kalium_acfpro_gm_tab_"+acf.data.post_id},setActiveTab:function(t){"object"==typeof store&&store.enabled&&store.set(a.cacheId(),{activeTab:t})},getActiveTab:function(){if("object"==typeof store&&store.enabled){var t=store.get(a.cacheId());if(t&&"activeTab"in t)return t.activeTab}return null}});var e=function(){"undefined"!=typeof acf&&this.init()};e.prototype.init=function(){var e=this,a="kalium-acfpro-grouped-metaboxes";this.groupedMetaboxes=_k.groupedMetaboxes,this.assignedContentTabs=[],this.currentTab="",this.$tabs=t("."+a+"-tabs"),this.$body=t("."+a+"-body"),this.$container=t("."+a+"-container"),this.buildTabsList(),this.assignContentTabs(),this.toggleVisibleTabs(),this.setActiveTab(),this.$container.addClass("loaded"),acf.addAction("check_screen_complete",function(t,a){e.assignContentTabs(),e.toggleVisibleTabs(),e.setActiveTab()})},e.prototype.getPostboxes=function(){var e=[],a=[];for(var i in this.groupedMetaboxes)a.push(i);return t.each(acf.getPostboxes(),function(i,s){var o=s.data.key;-1!==t.inArray(o,a)&&e.push(s)}),e},e.prototype.buildTabsList=function(){var e=this;t.each(this.groupedMetaboxes,function(a,i){var s=t('<li><a href="#"></a></li>'),o=i.title,n=i.icon;s.attr("data-group-key",a);var r=s.find("a");o=o.replace(/\s\(Portfolio Type.*?\)/i,""),r.html(o),n&&r.prepend('<i class="fa fa-'+n+'"></i>'),e.$tabs.append(s),r.on("click",function(t){t.preventDefault(),e.setActiveTab(a,!0)})})},e.prototype.assignContentTabs=function(){var e=this;t.each(e.getPostboxes(),function(a,i){var s=i.data.id,o=t("#"+s);if(-1===t.inArray(e.assignedContentTabs,s)){var n=t('<div class="tab-entry"></div>');n.appendTo(e.$body),n.append(i.$el),e.assignedContentTabs.push(s)}})},e.prototype.toggleVisibleTabs=function(){var e=this;t.each(e.getPostboxes(),function(t,a){var i=!a.isVisible(),s=e.getTab(a);s&&s.$el[i?"addClass":"removeClass"]("visible")}),this.maintainHeight()},e.prototype.maintainHeight=function(){this.$body.css("min-height",this.$tabs.outerHeight())},e.prototype.getTab=function(e){var a=this,i=null;return t.each(this.groupedMetaboxes,function(t,s){if(t===e.data.key)return(i=s).id=t,i.$el=a.$tabs.find('[data-group-key="'+t+'"]'),!1}),i},e.prototype.getActiveTab=function(){var e=this,i=null;return t.each(this.getPostboxes(),function(t,e){if(!e.isVisible())return i=e.data.key,!1}),t.each(this.getPostboxes(),function(t,e){if(a.getActiveTab()===e.data.key)return i=e.data.key,!1}),i},e.prototype.setActiveTab=function(t,e){t||(t=this.currentTab?this.currentTab:this.getActiveTab());var i=acf.getPostbox("acf-"+t);if(i){var s=this.getTab(i);s.$el.siblings().removeClass("active"),s.$el.addClass("active");var o=i.$el.parent(),n;o.siblings().removeClass("active"),o.addClass("active"),this.currentTab=t,e&&a.setActiveTab(t),this.maintainHeight()}};var i=function(){"undefined"!=typeof acf&&(acf.data.acf_version.match(/^5\.7\.[0-9]{2}$/)||acf.data.acf_version.match(/^5\.8\.[0-9]{1,2}$/)?new e:this.init())};i.prototype.init=function(){var e=this,i="kalium-acfpro-grouped-metaboxes";this.groupedMetaboxes=_k.groupedMetaboxes,this.currentTab="",this.$tabs=t("."+i+"-tabs"),this.$body=t("."+i+"-body"),this.$container=t("."+i+"-container"),this.postboxList=[];var s=acf.getPostboxes();t.each(s,function(t,a){var i=a.get("key");if(i in e.groupedMetaboxes){var s=e.groupedMetaboxes[i];s.isVisible=function(){return a.$el.attr("style")?!a.$el.attr("style").match(/display:\s?none/):a.isVisible()},a.set("groupedMetaboxData",s),e.postboxList.push(a)}}),this.buildTabsList(),this.toggleVisibleTabs();var o=a.getActiveTab();o&&this.setActiveTab(o,!0),e.resetCurrentTab(),this.$container.addClass("loaded"),acf.addFilter("check_screen_args",function(t){return a.setLoading(!0),t}),acf.addAction("check_screen_complete",function(t,i){e.toggleVisibleTabs(),e.resetCurrentTab(),a.setLoading(!1)})},i.prototype.buildTabsList=function(){var e=this;t.each(this.postboxList,function(a,i){var s=t('<li><a href="#"></a></li>'),o=t('<div class="tab-entry"></div>'),n=i.get("groupedMetaboxData"),r=i.get("id"),c=n.title,d=n.icon,p=s.find("a");c=c.replace(/\s\(Portfolio Type.*?\)/i,""),p.html(c),d&&p.prepend('<i class="fa fa-'+d+'"></i>'),n.$tab=s,e.$tabs.append(s),o.appendTo(e.$body),o.append(i.$el),p.on("click",function(t){t.preventDefault(),e.setActiveTab(r,!0)})})},i.prototype.toggleVisibleTabs=function(){t.each(this.postboxList,function(t,e){var a=e.get("groupedMetaboxData");a.$tab[a.isVisible()?"addClass":"removeClass"]("visible")}),this.maintainHeight()},i.prototype.maintainHeight=function(){this.$body.css("min-height",this.$tabs.outerHeight())},i.prototype.setActiveTab=function(t,e){var i=acf.getPostbox(t);if(i&&i.get("id")!==this.currentTab){var s=i.get("id"),o=i.get("groupedMetaboxData");this.$body.find(".tab-entry.active").removeClass("active"),this.$tabs.find("li.active").removeClass("active"),o.$tab.addClass("active"),i.$el.parent().addClass("active"),e&&a.setActiveTab(s),this.currentTab=s,this.maintainHeight()}},i.prototype.resetCurrentTab=function(){var e=this,a=!1;t.each(this.postboxList,function(t,e){var i=e.get("groupedMetaboxData");if(i.isVisible()&&i.$tab.hasClass("active"))return a=!0,!1}),a||t.each(this.postboxList,function(t,a){var i=a.get("id"),s;if(a.get("groupedMetaboxData").isVisible())return e.setActiveTab(i),!1})},new i}})}(jQuery,window,kaliumGroupedMetaboxes),function(t,e){"use strict";t(document).ready(function(){if("undefined"!=typeof acf){var a=function(a){var i="kalium-acfpro-portfolio-item-type",s={"type-1":"portfolio-item-type-1.png","type-2":"portfolio-item-type-2.png","type-3":"portfolio-item-type-3.png","type-4":"portfolio-item-type-4.png","type-5":"portfolio-item-type-5.png","type-6":"portfolio-item-type-6.png","type-7":"portfolio-item-type-7.png"};for(var o in s)s[o]=_k.kaliumAssetsDir+"images/admin/"+s[o];a.addClass(i);var n=a.find(".acf-input"),r=n.find("select"),c=e.location.toString().match(/action=edit/),d=[r.val(),r.find("option:selected").html()],p=r.val(),l=t('<div class="'+i+'-images"><div class="loader"></div></div>');n.before(l),r.find("option").each(function(e,a){var o=t(a),n=o.val(),c=o.html(),d=t('<a href="#" class="'+i+'-option" data-value="'+n+'"><span><img src="'+s[n]+'" /></span><strong>'+c+"</strong></a>");d.find("img").on("load",function(){t(this).addClass("loaded")}),l.append(d),d.on("click",function(t){t.preventDefault(),o.prop("selected",!0).attr("selected",!0),r.trigger("change")})});var u=t('<div class="'+i+'-warning"></div>');c&&(u.append("<strong>Note:</strong> You are currently using <strong>"+d[1]+"</strong> type. If you change this portfolio type you may lose/overwrite some of the current settings."),l.after(u));var f=function(t){var e=r.val();(t||p!=e)&&(l.find("."+i+"-option").removeClass("active"),l.find("."+i+'-option[data-value="'+e+'"]').addClass("active"),p=e,acf.screen.data.item_type=e,acf.screen.check(),l.addClass("is-loading"),kaliumGroupedMetaboxes.setLoading(!0),e!=d[0]?u.slideDown(300):u.slideUp(300))};r.on("change",f),l.find("."+i+'-option[data-value="'+r.val()+'"]').addClass("active"),acf.addAction("check_screen_complete",function(t,e){"item_type"in e&&(l.removeClass("is-loading"),kaliumGroupedMetaboxes.setLoading(!1))},1),"post-new-php"==adminpage&&f(!0)},i=acf.getFields({name:"item_type"});i.length&&t.each(i,function(t,e){var i=e.$el;a(i)})}})}(jQuery,window);